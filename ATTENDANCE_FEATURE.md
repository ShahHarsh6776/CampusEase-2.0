# Attendance Management System - Faculty Feature

## Overview
The Attendance Management System is a new faculty-exclusive feature added to CampusEase that allows faculty members to mark and manage student attendance for their classes.

## Features

### 1. Access Control
- **Faculty Only**: Only users with the 'faculty' role can access the attendance page
- **Automatic Redirection**: Non-faculty users are automatically redirected to the home page with an error message

### 2. Mark Attendance
- **Student List**: View all students with their details (ID, name, course)
- **Attendance Status**: Mark students as Present, Late, or Absent
- **Real-time Updates**: Attendance status is updated immediately and reflected in the UI
- **Search Functionality**: Search students by name or student ID

### 3. Class Management
- **Date Selection**: Choose the date for marking attendance
- **Subject Selection**: Select from predefined subjects or add custom ones
- **Class Type**: Specify whether it's Theory, Practical, Tutorial, or Seminar
- **Statistics**: View real-time stats of present, absent, and late students

### 4. Database Integration
- **Unique Constraints**: Prevents duplicate attendance entries for the same student, date, and subject
- **Data Validation**: Ensures data integrity with proper validation rules
- **Faculty Tracking**: Records which faculty member marked the attendance

## How to Use

### For Faculty Members:

1. **Login** with your faculty credentials (ID format: `fac_[department][number]`)
2. **Navigate** to the Attendance page (visible in the main navigation)
3. **Select Class Details**:
   - Choose the date
   - Select the subject
   - Pick the class type
4. **Mark Attendance**:
   - Use the Present (✓), Late (⏰), or Absent (✗) buttons for each student
   - Search for specific students using the search box
5. **Save Attendance**: Click "Save Attendance" to confirm all entries

### Available Subjects:
- Data Structures
- Database Management
- Computer Networks
- Operating Systems
- Software Engineering
- Web Development
- Machine Learning
- Computer Graphics
- Mobile App Development
- Cyber Security

### Available Class Types:
- Theory
- Practical
- Tutorial
- Seminar

## Technical Implementation

### Database Schema
```sql
-- Attendance Table
create table public.attendance (
  id bigint generated by default as identity not null,
  student_id text not null,
  student_name text not null,
  date date not null,
  subject text not null,
  class_type text not null,
  status text not null check (status in ('present', 'absent', 'late')),
  marked_by text not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null,
  constraint attendance_pkey primary key (id),
  constraint unique_attendance unique (student_id, date, subject, marked_by)
);
```

### Route Protection
- Uses `FacultyRoute` component wrapper
- Checks user role before rendering
- Automatically redirects non-faculty users

### Key Files Added/Modified:
1. **`src/pages/Attendance.tsx`** - Main attendance component
2. **`src/App.tsx`** - Added route and FacultyRoute component
3. **`src/components/Header.tsx`** - Added attendance link for faculty
4. **`src/supabase/schema.sql`** - Added attendance table schema

## Future Enhancements

### Planned Features:
1. **Attendance Reports**: Generate and download attendance reports
2. **Attendance Analytics**: View attendance patterns and statistics
3. **Bulk Operations**: Mark attendance for entire class with one click
4. **Attendance History**: View previously marked attendance
5. **Email Notifications**: Notify students about their attendance status
6. **QR Code Attendance**: Quick attendance marking using QR codes

### Potential Improvements:
- Mobile responsiveness optimization
- Offline support for marking attendance
- Integration with academic calendar
- Automated attendance reminders
- Parent/guardian notifications for low attendance

## Security Features

1. **Role-based Access**: Only faculty can access attendance features
2. **Data Validation**: Prevents invalid attendance entries
3. **Audit Trail**: Tracks who marked attendance and when
4. **Unique Constraints**: Prevents duplicate entries

## API Endpoints

The attendance system uses the following Supabase operations:
- `SELECT` from `users` table to fetch students
- `SELECT` from `attendance` table to fetch existing attendance
- `INSERT` into `attendance` table for new records
- `UPDATE` attendance table for modifying existing records

## Troubleshooting

### Common Issues:

1. **Access Denied Error**:
   - Ensure you're logged in with a faculty account
   - Check that your user role is set to 'faculty'

2. **Attendance Not Saving**:
   - Ensure all required fields are selected (date, subject, class type)
   - Check network connectivity
   - Verify Supabase connection

3. **Students Not Loading**:
   - Check database connection
   - Verify `users` table has student data
   - Check console for error messages

### Contact Support:
If you encounter any issues, please contact the system administrator or check the browser console for detailed error messages.